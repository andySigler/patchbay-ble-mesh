{"ast":null,"code":"import * as utils from './DrawUtils';\nconst cordDefaults = {\n  lineWidthPixels: 3,\n  screenSizeScaler: 0.02,\n  wobbleStep: 0.05,\n  wobbleScaler: 0.2,\n  crossSignThicknessScaler: 0.75,\n  crossSignScaler: 0.6\n};\n\nclass Connection {\n  constructor(params, inPort, outPort) {\n    this.params = params;\n    this.context = params.context;\n    this.name = this.constructor.generateName(inPort, outPort);\n    this.inPort = inPort;\n    this.outPort = outPort;\n    this._selected = false;\n    this.lineWidth = undefined; // the location and size of the delete circle\n\n    this._x = undefined;\n    this._y = undefined;\n    this._radius = undefined; // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbledRadius = undefined;\n    this.crossSignThickness = undefined;\n    this.crossSignRadius = undefined; // colors\n\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID->inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(inID + '/' + inIndex + '->' + outID + '/' + outIndex);\n  } // GETTERS\n\n\n  get selected() {\n    return this._selected;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get visible() {\n    return Boolean(this.inPort.visible && this.outPort.visible);\n  }\n\n  get sizeScaler() {\n    return Math.min(this.inPort.sizeScaler, this.outPort.sizeScaler);\n  } // SETTERS\n\n\n  set selected(newVal) {\n    this._selected = newVal;\n  }\n\n  onScreenUpdate(screenSize) {\n    this._radius = screenSize * cordDefaults.screenSizeScaler;\n  }\n\n  update() {\n    if (this.visible) {\n      // the coordinate where a deletion circle would be\n      // will be halfway between the two ports\n      this._x = (this.outPort.x - this.inPort.x) / 2 + this.inPort.x;\n      this._y = (this.outPort.y - this.inPort.y) / 2 + this.inPort.y;\n      this.lineWidth = cordDefaults.lineWidthPixels * this.sizeScaler; // colors\n\n      this.lineFill = utils.colors.white(this.sizeScaler);\n      this.lineStroke = utils.colors.white(this.sizeScaler);\n\n      if (this._selected) {\n        this.wobbleCounter = (this.wobbleCounter + cordDefaults.wobbleStep) % utils.PI2;\n\n        const wobbleRadiusAdder = Math.sin(this.wobbleCounter) * cordDefaults.wobbleScaler * this._radius;\n\n        const wobbledRadius = this._radius + wobbleRadiusAdder;\n        this.wobbledRadius = wobbledRadius * this.sizeScaler;\n        this.crossSignRadius = this.wobbledRadius * cordDefaults.crossSignScaler;\n        this.crossSignThickness = this.lineWidth * cordDefaults.crossSignThicknessScaler; // colors\n\n        this.lineStroke = utils.colors.red(this.sizeScaler);\n        this.delCircleFill = utils.colors.white(this.sizeScaler);\n        this.delCircleStroke = utils.colors.red(this.sizeScaler);\n      }\n    }\n  }\n\n  draw() {\n    if (this.visible) {\n      this.context.save();\n      utils.drawLine(this.context, this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y, this.lineWidth, this.lineStroke); // draw the two circles on top of that line, inside each port\n      // these make the edges of the line look a bit nicer\n\n      utils.drawCircle(this.context, this.outPort.x, this.outPort.y, this.lineWidth, 0, // use the line's width for a radius\n      undefined, this.lineFill);\n      utils.drawCircle(this.context, this.inPort.x, this.inPort.y, this.lineWidth, 0, // use the line's width for a radius\n      undefined, this.lineFill);\n      this.context.restore();\n\n      if (this._selected) {\n        this.drawDeleteCircle();\n      }\n    }\n  }\n\n  drawDeleteCircle() {\n    this.context.save();\n    this.context.translate(this._x, this._y); // the cross's bounding circle\n\n    utils.drawCircle(this.context, 0, 0, this.wobbledRadius, this.lineWidth, this.delCircleStroke, this.delCircleFill); // two lines, to create a cross \"X\"\n\n    this.context.rotate(utils.PI / 4);\n    utils.drawLine(this.context, 0, this.crossSignRadius, 0, -this.crossSignRadius, this.crossSignThickness, this.delCircleStroke);\n    this.context.rotate(-utils.PI / 2);\n    utils.drawLine(this.context, 0, this.crossSignRadius, 0, -this.crossSignRadius, this.crossSignThickness, this.delCircleStroke); // restore the context's state\n\n    this.context.restore();\n  }\n\n  isUserTouching(x, y) {\n    if (!this._selected) {\n      return false;\n    }\n\n    const dist = utils.getDistance(x, y, this._x, this._y);\n\n    if (dist < this._radius) {\n      return true;\n    }\n\n    return false;\n  }\n\n}\n\nexport { Connection };","map":{"version":3,"sources":["/Users/andy/Documents/patchbay-react/patchbay-react/src/modules/Connection.js"],"names":["utils","cordDefaults","lineWidthPixels","screenSizeScaler","wobbleStep","wobbleScaler","crossSignThicknessScaler","crossSignScaler","Connection","constructor","params","inPort","outPort","context","name","generateName","_selected","lineWidth","undefined","_x","_y","_radius","wobbleCounter","Math","random","PI2","wobbledRadius","crossSignThickness","crossSignRadius","lineFill","lineStroke","delCircleFill","delCircleStroke","inID","parent","id","inIndex","index","outID","outIndex","String","selected","x","y","visible","Boolean","sizeScaler","min","newVal","onScreenUpdate","screenSize","update","colors","white","wobbleRadiusAdder","sin","red","draw","save","drawLine","drawCircle","restore","drawDeleteCircle","translate","rotate","PI","isUserTouching","dist","getDistance"],"mappings":"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","sourcesContent":["import * as utils from './DrawUtils'\n\nconst cordDefaults = {\n  lineWidthPixels: 3,\n  screenSizeScaler: 0.02,\n  wobbleStep: 0.05,\n  wobbleScaler: 0.2,\n  crossSignThicknessScaler: 0.75,\n  crossSignScaler: 0.6\n};\n\nclass Connection {\n  constructor (params, inPort, outPort) {\n    this.params = params;\n    this.context = params.context;\n    this.name = this.constructor.generateName(inPort, outPort);\n\n    this.inPort = inPort;\n    this.outPort = outPort;\n\n    this._selected = false;\n\n    this.lineWidth = undefined;\n\n    // the location and size of the delete circle\n    this._x = undefined;\n    this._y = undefined;\n    this._radius = undefined;\n\n    // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbledRadius = undefined;\n    this.crossSignThickness = undefined;\n    this.crossSignRadius = undefined;\n\n    // colors\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID->inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(\n      inID + '/' + inIndex + '->' + outID + '/' + outIndex);\n  }\n\n  // GETTERS\n\n  get selected () { return this._selected }\n\n  get x () { return this._x }\n\n  get y () { return this._y }\n\n  get visible () { return Boolean(this.inPort.visible && this.outPort.visible); }\n\n  get sizeScaler () {\n    return Math.min(this.inPort.sizeScaler, this.outPort.sizeScaler);\n  }\n\n  // SETTERS\n\n  set selected (newVal) { this._selected = newVal; }\n\n  onScreenUpdate (screenSize) {\n    this._radius = screenSize * cordDefaults.screenSizeScaler;\n  }\n\n  update () {\n    if (this.visible) {\n      // the coordinate where a deletion circle would be\n      // will be halfway between the two ports\n      this._x = ((this.outPort.x - this.inPort.x) / 2) + this.inPort.x;\n      this._y = ((this.outPort.y - this.inPort.y) / 2) + this.inPort.y;\n\n      this.lineWidth = cordDefaults.lineWidthPixels * this.sizeScaler;\n\n      // colors\n      this.lineFill = utils.colors.white(this.sizeScaler);\n      this.lineStroke = utils.colors.white(this.sizeScaler);\n\n      if (this._selected) {\n        this.wobbleCounter = (this.wobbleCounter + cordDefaults.wobbleStep) % utils.PI2;\n        const wobbleRadiusAdder = Math.sin(this.wobbleCounter) * cordDefaults.wobbleScaler * this._radius;\n        const wobbledRadius = this._radius + wobbleRadiusAdder;\n        this.wobbledRadius = wobbledRadius * this.sizeScaler;\n        this.crossSignRadius = this.wobbledRadius * cordDefaults.crossSignScaler;\n        this.crossSignThickness = this.lineWidth * cordDefaults.crossSignThicknessScaler;\n        // colors\n        this.lineStroke = utils.colors.red(this.sizeScaler);\n        this.delCircleFill = utils.colors.white(this.sizeScaler);\n        this.delCircleStroke = utils.colors.red(this.sizeScaler);\n      }\n    }\n  }\n\n  draw () {\n    if(this.visible){\n      this.context.save();\n      utils.drawLine(\n        this.context,\n        this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y,\n        this.lineWidth, this.lineStroke\n      );\n      // draw the two circles on top of that line, inside each port\n      // these make the edges of the line look a bit nicer\n      utils.drawCircle(\n        this.context,\n        this.outPort.x, this.outPort.y,\n        this.lineWidth, 0, // use the line's width for a radius\n        undefined, this.lineFill\n      )\n      utils.drawCircle(\n        this.context,\n        this.inPort.x, this.inPort.y,\n        this.lineWidth, 0, // use the line's width for a radius\n        undefined, this.lineFill\n      )\n      this.context.restore();\n      if(this._selected){\n        this.drawDeleteCircle();\n      }\n    }\n  }\n\n  drawDeleteCircle () {\n    this.context.save();\n    this.context.translate(this._x, this._y);\n    // the cross's bounding circle\n    utils.drawCircle(\n      this.context,\n      0, 0,\n      this.wobbledRadius, this.lineWidth,\n      this.delCircleStroke, this.delCircleFill\n    )\n    // two lines, to create a cross \"X\"\n    this.context.rotate(utils.PI / 4);\n    utils.drawLine(\n      this.context,\n      0, this.crossSignRadius, 0, -this.crossSignRadius,\n      this.crossSignThickness, this.delCircleStroke\n    );\n    this.context.rotate(-utils.PI / 2);\n    utils.drawLine(\n      this.context,\n      0, this.crossSignRadius, 0, -this.crossSignRadius,\n      this.crossSignThickness, this.delCircleStroke\n    );\n    // restore the context's state\n    this.context.restore();\n  }\n\n  isUserTouching (x, y) {\n    if (!this._selected) {\n      return false;\n    }\n    const dist = utils.getDistance(x, y, this._x, this._y);\n    if (dist < this._radius) {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport { Connection }\n"]},"metadata":{},"sourceType":"module"}