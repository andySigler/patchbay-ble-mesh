{"ast":null,"code":"import * as utils from './DrawUtils';\nconst cordDefaults = {\n  width: 2,\n  wobbleStep: 0.05,\n  wobbleAmount: 2,\n  drawSizeScaler: 0.04,\n  lineWidthScaler: 0.003,\n  lineWidthOpacityScaler: 2,\n  circleSizeOpacityScaler: 2,\n  opacityScaler: 1.5,\n  deleteLineWidthScaler: 0.15,\n  wobbleSizeScaler: 0.5,\n  wobbleLineLengthScaler: 0.6\n};\n\nclass Connection {\n  constructor(params, inPort, outPort) {\n    this.params = params;\n    this.name = this.constructor.generateName(inPort, outPort);\n    this.inPort = inPort;\n    this.outPort = outPort;\n    this._selected = false;\n    this.lineWidth = cordDefaults.width; // the location and size of the delete circle\n\n    this._x = undefined;\n    this._y = undefined;\n    this._radius = undefined; // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbleStep = cordDefaults.wobbleStep;\n    this.wobbleAmount = cordDefaults.wobbleAmount;\n    this.circleSize = undefined;\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n    this.delLineWidth = undefined;\n    this.wobbleSize = undefined;\n    this.wobbleLineLength = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID_inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(inID + '/' + inIndex + '_' + outID + '/' + outIndex);\n  } // GETTERS\n\n\n  get selected() {\n    return this._selected;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get visible() {\n    return this.inPort.visible && this.outPort.visible;\n  }\n\n  get sizeScaler() {\n    return Math.min(this.inPort.sizeScaler, this.outPort.sizeScaler);\n  } // SETTERS\n\n\n  set selected(newVal) {\n    this._selected = newVal;\n  }\n\n  update() {\n    // the coordinate where a deletion circle would be\n    // will be halfway between the two ports\n    this._x = (this.outPort.x - this.inPort.x) / 2 + this.inPort.x;\n    this._y = (this.outPort.y - this.inPort.y) / 2 + this.inPort.y; // incase the overall size has changed, update the size variables\n\n    this._radius = this.params.screenSize * cordDefaults.drawSizeScaler;\n    this.lineWidth = Math.max(this.params.screenSize * cordDefaults.lineWidthScaler, 2); // increment the sinusoidal wobbling variable\n\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % (Math.PI * 2);\n    this.updateDrawSettings();\n  }\n\n  updateDrawSettings() {\n    // the visible flag is set by the Arc\n    if (this.outPort.visible && this.inPort.visible) {\n      // the opacity depends on the size of the parent ports' circles\n      let opacity = Math.min(this.outPort.sizeScaler, this.inPort.sizeScaler);\n      opacity = Math.min(opacity * cordDefaults.opacityScaler, 1); // that scaled opacity then controls all other variables for the line\n\n      this.lineWidth = Math.floor(this.lineWidth * opacity * cordDefaults.lineWidthOpacityScaler);\n      this.circleSize = Math.floor(this.lineWidth * opacity * cordDefaults.circleSizeOpacityScaler);\n      this.lineFill = utils.colors.white(opacity);\n      this.lineStroke = utils.colors.white(opacity);\n\n      if (this._selected) {\n        this.lineStroke = utils.colors.red(opacity);\n        this.delCircleFill = utils.colors.white(opacity);\n        this.delCircleStroke = utils.colors.red(opacity);\n        const sineVal = this._radius + Math.sin(this.wobbleCounter) * this.wobbleAmount;\n        this.delLineWidth = sineVal * cordDefaults.deleteLineWidthScaler;\n        this.wobbleSize = sineVal * opacity * cordDefaults.wobbleSizeScaler;\n        this.wobbleLineLength = this.wobbleSize * cordDefaults.wobbleLineLengthScaler;\n      }\n    }\n  }\n\n  draw() {\n    if (this.visible) {\n      // save the context state\n      this.params.context.save(); // draw the line, from the input port to the output port\n\n      utils.drawLine(this.params.context, this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y, this.lineWidth, this.lineStroke); // draw the two circles on top of that line, inside each port\n\n      utils.drawArc(this.params.context, this.outPort.x, this.outPort.y, this.circleSize, 0, utils.PI2, this.lineWidth, undefined, this.lineFill);\n      utils.drawArc(this.params.context, this.inPort.x, this.inPort.y, this.circleSize, 0, utils.PI2, this.lineWidth, undefined, this.lineFill); // restore the context state\n\n      this.params.context.restore();\n\n      if (this._selected) {\n        this.drawDeleteCircle();\n      }\n    }\n  }\n\n  drawDeleteCircle() {\n    // save the context's state\n    this.params.context.save(); // translate to where the delete circle is\n\n    this.params.context.translate(this._x, this._y); // draw the circle, with a fill and a stroke\n\n    utils.drawArc(this.params.context, 0, 0, this.wobbleSize, 0, utils.PI2, this.lineWidth, this.delCircleStroke, this.delCircleFill); // draw the two lines that make the X\n\n    this.params.context.rotate(utils.PI / 4);\n    utils.drawLine(this.params.context, 0, this.wobbleLineLength, 0, -this.wobbleLineLength, this.delLineWidth, this.delCircleStroke);\n    this.params.context.rotate(-utils.PI / 2);\n    utils.drawLine(this.params.context, 0, this.wobbleLineLength, 0, -this.wobbleLineLength, this.delLineWidth, this.delCircleStroke); // restore the context's state\n\n    this.params.context.restore();\n  }\n\n  isUserTouching(x, y) {\n    if (!this._selected) {\n      return false;\n    }\n\n    const dist = utils.getDistance(x, y, this._x, this._y);\n\n    if (dist < this._radius) {\n      return true;\n    }\n\n    return false;\n  }\n\n}\n\nexport { Connection };","map":{"version":3,"sources":["/Users/andy/Documents/patchbay-react/patchbay-react/src/modules/Connection.js"],"names":["utils","cordDefaults","width","wobbleStep","wobbleAmount","drawSizeScaler","lineWidthScaler","lineWidthOpacityScaler","circleSizeOpacityScaler","opacityScaler","deleteLineWidthScaler","wobbleSizeScaler","wobbleLineLengthScaler","Connection","constructor","params","inPort","outPort","name","generateName","_selected","lineWidth","_x","undefined","_y","_radius","wobbleCounter","Math","random","PI2","circleSize","lineFill","lineStroke","delCircleFill","delCircleStroke","delLineWidth","wobbleSize","wobbleLineLength","inID","parent","id","inIndex","index","outID","outIndex","String","selected","x","y","visible","sizeScaler","min","newVal","update","screenSize","max","PI","updateDrawSettings","opacity","floor","colors","white","red","sineVal","sin","draw","context","save","drawLine","drawArc","restore","drawDeleteCircle","translate","rotate","isUserTouching","dist","getDistance"],"mappings":"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","sourcesContent":["import * as utils from './DrawUtils'\n\nconst cordDefaults = {\n  width: 2,\n  wobbleStep: 0.05,\n  wobbleAmount: 2,\n  drawSizeScaler: 0.04,\n  lineWidthScaler: 0.003,\n  lineWidthOpacityScaler: 2,\n  circleSizeOpacityScaler: 2,\n  opacityScaler: 1.5,\n  deleteLineWidthScaler: 0.15,\n  wobbleSizeScaler: 0.5,\n  wobbleLineLengthScaler: 0.6\n};\n\nclass Connection {\n  constructor (params, inPort, outPort) {\n    this.params = params;\n    this.name = this.constructor.generateName(inPort, outPort);\n\n    this.inPort = inPort;\n    this.outPort = outPort;\n\n    this._selected = false;\n\n    this.lineWidth = cordDefaults.width;\n\n    // the location and size of the delete circle\n    this._x = undefined;\n    this._y = undefined;\n    this._radius = undefined;\n\n    // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbleStep = cordDefaults.wobbleStep;\n    this.wobbleAmount = cordDefaults.wobbleAmount;\n\n    this.circleSize = undefined;\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n    this.delLineWidth = undefined;\n    this.wobbleSize = undefined;\n    this.wobbleLineLength = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID_inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(\n      inID + '/' + inIndex + '_' + outID + '/' + outIndex);\n  }\n\n  // GETTERS\n\n  get selected () { return this._selected }\n\n  get x () { return this._x }\n\n  get y () { return this._y }\n\n  get visible () { return this.inPort.visible && this.outPort.visible; }\n\n  get sizeScaler () { return Math.min(this.inPort.sizeScaler, this.outPort.sizeScaler); }\n\n  // SETTERS\n\n  set selected (newVal) { this._selected = newVal; }\n\n  update () {\n    // the coordinate where a deletion circle would be\n    // will be halfway between the two ports\n    this._x = ((this.outPort.x - this.inPort.x) / 2) + this.inPort.x;\n    this._y = ((this.outPort.y - this.inPort.y) / 2) + this.inPort.y;\n\n    // incase the overall size has changed, update the size variables\n    this._radius = this.params.screenSize * cordDefaults.drawSizeScaler;\n    this.lineWidth = Math.max(this.params.screenSize * cordDefaults.lineWidthScaler, 2);\n\n    // increment the sinusoidal wobbling variable\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % (Math.PI * 2);\n\n    this.updateDrawSettings();\n  }\n\n  updateDrawSettings () {\n    // the visible flag is set by the Arc\n    if(this.outPort.visible && this.inPort.visible){\n      // the opacity depends on the size of the parent ports' circles\n      let opacity = Math.min(this.outPort.sizeScaler, this.inPort.sizeScaler);\n      opacity = Math.min(opacity * cordDefaults.opacityScaler, 1);\n      // that scaled opacity then controls all other variables for the line\n      this.lineWidth = Math.floor(this.lineWidth * opacity * cordDefaults.lineWidthOpacityScaler);\n      this.circleSize =  Math.floor(this.lineWidth * opacity * cordDefaults.circleSizeOpacityScaler);\n      this.lineFill = utils.colors.white(opacity);\n      this.lineStroke = utils.colors.white(opacity);\n      if(this._selected) {\n        this.lineStroke = utils.colors.red(opacity);\n        this.delCircleFill = utils.colors.white(opacity);\n        this.delCircleStroke = utils.colors.red(opacity);\n        const sineVal = this._radius + (Math.sin(this.wobbleCounter) * this.wobbleAmount);\n        this.delLineWidth = sineVal * cordDefaults.deleteLineWidthScaler;\n        this.wobbleSize = sineVal * opacity * cordDefaults.wobbleSizeScaler;\n        this.wobbleLineLength = this.wobbleSize * cordDefaults.wobbleLineLengthScaler;\n      }\n    }\n  }\n\n  draw () {\n    if(this.visible){\n      // save the context state\n      this.params.context.save();\n      // draw the line, from the input port to the output port\n      utils.drawLine(\n        this.params.context,\n        this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y,\n        this.lineWidth, this.lineStroke\n      );\n      // draw the two circles on top of that line, inside each port\n      utils.drawArc(\n        this.params.context,\n        this.outPort.x, this.outPort.y,\n        this.circleSize, 0, utils.PI2,\n        this.lineWidth, undefined, this.lineFill\n      )\n      utils.drawArc(\n        this.params.context,\n        this.inPort.x, this.inPort.y,\n        this.circleSize, 0, utils.PI2,\n        this.lineWidth, undefined, this.lineFill\n      )\n      // restore the context state\n      this.params.context.restore();\n\n      if(this._selected){\n        this.drawDeleteCircle();\n      }\n    }\n  }\n\n  drawDeleteCircle () {\n    // save the context's state\n    this.params.context.save();\n    // translate to where the delete circle is\n    this.params.context.translate(this._x, this._y);\n    // draw the circle, with a fill and a stroke\n    utils.drawArc(\n      this.params.context,\n      0, 0,\n      this.wobbleSize, 0, utils.PI2,\n      this.lineWidth, this.delCircleStroke, this.delCircleFill\n    )\n    // draw the two lines that make the X\n    this.params.context.rotate(utils.PI / 4);\n    utils.drawLine(\n      this.params.context,\n      0, this.wobbleLineLength, 0, -this.wobbleLineLength,\n      this.delLineWidth, this.delCircleStroke\n    );\n    this.params.context.rotate(-utils.PI / 2);\n    utils.drawLine(\n      this.params.context,\n      0, this.wobbleLineLength, 0, -this.wobbleLineLength,\n      this.delLineWidth, this.delCircleStroke\n    );\n    // restore the context's state\n    this.params.context.restore();\n  }\n\n  isUserTouching (x, y) {\n    if (!this._selected) {\n      return false;\n    }\n    const dist = utils.getDistance(x, y, this._x, this._y);\n    if (dist < this._radius) {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport { Connection }\n"]},"metadata":{},"sourceType":"module"}