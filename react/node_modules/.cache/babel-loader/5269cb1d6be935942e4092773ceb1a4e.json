{"ast":null,"code":"import * as utils from './DrawUtils';\nconst portDefaults = {\n  wobbleStep: 0.07,\n  wobbleAmount: 3,\n  circleSizeScaler: 0.4,\n  circleSizeDrawThresh: 2,\n  lineWidthScaler: 0.4,\n  minCircleSize: 1,\n  fillTextFontSizeScaler: 0.2,\n  radOffsetScaler: 0.05,\n  fontSizeScaler: 0.4,\n  touchingScaler: 1.0\n};\n\nclass Port {\n  constructor(params, parent, type, index) {\n    this.params = params;\n    this.context = this.params.context;\n    this._parent = parent;\n    this._type = type;\n    this._index = index;\n    this._name = \"\";\n    this.connections = {};\n    this._x = 0;\n    this._y = 0;\n    this.relX = 0;\n    this.relY = 0;\n    this._touched = false;\n    this._hovered = false;\n    this.sizeScaler = 0;\n    this.circleRad = undefined;\n    this._arcLineWidth = undefined;\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbleStep = portDefaults.wobbleStep;\n    this.wobbleAmount = portDefaults.wobbleAmount;\n    this.circleSize = undefined;\n    this.lineWidth = undefined;\n    this.strokeStyle = utils.colors.background();\n    this.fillStyle = this._parent.color();\n    this.shouldDraw = false;\n    this.radOffset = undefined; // the visible flag is used by Cords to determine if they should be shown\n\n    this._visible = false;\n  } // GETTERS\n\n\n  get visible() {\n    return this._visible;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get touched() {\n    return this._touched;\n  }\n\n  get hovered() {\n    return this._hovered;\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get index() {\n    return this._index;\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  get parent() {\n    return this._parent;\n  }\n\n  get size() {\n    return this._arcLineWidth;\n  } // SETTERS\n\n\n  set touched(state) {\n    this._touched = state;\n  }\n\n  set hovered(state) {\n    this._hovered = state;\n  }\n\n  set name(name) {\n    this._name = name;\n  }\n\n  update(sizeScaler, radLocation, isVisible) {\n    this.updateFrameSettings(sizeScaler, isVisible);\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % utils.PI2; // Ports need an absolute coordinate on the screen\n    // because their position is used to determine when they are being\n    // interacted with\n\n    this._x = this.circleRad * Math.cos(radLocation) + this.relX;\n    this._y = this.circleRad * Math.sin(radLocation) + this.relY;\n  }\n\n  onScreenUpdate(rad, lineWidth, relX, relY) {\n    this.circleRad = rad;\n    this._arcLineWidth = lineWidth;\n    this.relX = relX;\n    this.relY = relY;\n  }\n\n  updateFrameSettings(sizeScaler, isVisible) {\n    this.sizeScaler = sizeScaler;\n    this.circleSize = this._arcLineWidth * this.sizeScaler * portDefaults.circleSizeScaler;\n    this._visible = isVisible;\n\n    if (this._visible && this.circleSize > portDefaults.circleSizeDrawThresh) {\n      if (this.params.touchedPort && this.params.touchedPort.type !== this._type) {\n        // wobble the port's radius, if `touchedPort` is from the other circle\n        this.circleSize += Math.sin(this.wobbleCounter) * this.wobbleAmount;\n      }\n\n      this.circleSize = utils.clipValue(this.circleSize, portDefaults.minCircleSize, this._arcLineWidth);\n      this.lineWidth = Math.floor(this.circleSize * portDefaults.lineWidthScaler);\n    } // settings for drawing the name\n\n\n    this.radOffset = this._parent.radius - this.params.screenSize * portDefaults.radOffsetScaler;\n    this.fontSize = Math.floor(this.sizeScaler * this._arcLineWidth * portDefaults.fontSizeScaler);\n  }\n\n  draw() {\n    ;\n\n    if (this._visible) {\n      this.context.save();\n      utils.drawArc(this.context, 0, this.circleRad, this.circleSize, 0, utils.PI2, this.lineWidth, this.strokeStyle, this.fillStyle);\n      this.context.restore();\n    }\n  }\n\n  drawName() {\n    this.context.save();\n    this.context.translate(this.radOffset, 0);\n\n    if (this._x < this._parent.parent.centerX) {\n      this.context.textAlign = 'left';\n      this.context.rotate(Math.PI);\n    } else {\n      this.context.textAlign = 'right';\n    }\n\n    this.context.font = this.fontSize + 'px Helvetica';\n\n    if (this._touched || this._hovered) {\n      this.context.fillStyle = utils.colors.white();\n    } else {\n      this.context.fillStyle = this.fillStyle;\n    }\n\n    this.context.fillText(this._name, 0, this.fontSize * portDefaults.fillTextFontSizeScaler);\n    this.context.restore();\n  }\n\n  isTouching(x, y) {\n    const dist = utils.getDistance(this._x, this._y, x, y);\n\n    if (this._visible && dist < this.circleSize) {\n      return true;\n    }\n\n    return false;\n  }\n\n}\n\nexport { Port };","map":{"version":3,"sources":["/Users/andy/Documents/patchbay-react/patchbay-react/src/modules/Port.js"],"names":["utils","portDefaults","wobbleStep","wobbleAmount","circleSizeScaler","circleSizeDrawThresh","lineWidthScaler","minCircleSize","fillTextFontSizeScaler","radOffsetScaler","fontSizeScaler","touchingScaler","Port","constructor","params","parent","type","index","context","_parent","_type","_index","_name","connections","_x","_y","relX","relY","_touched","_hovered","sizeScaler","circleRad","undefined","_arcLineWidth","wobbleCounter","Math","random","PI2","circleSize","lineWidth","strokeStyle","colors","background","fillStyle","color","shouldDraw","radOffset","_visible","visible","x","y","touched","hovered","name","size","state","update","radLocation","isVisible","updateFrameSettings","cos","sin","onScreenUpdate","rad","touchedPort","clipValue","floor","radius","screenSize","fontSize","draw","save","drawArc","restore","drawName","translate","centerX","textAlign","rotate","PI","font","white","fillText","isTouching","dist","getDistance"],"mappings":"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","sourcesContent":["import * as utils from './DrawUtils'\n\nconst portDefaults = {\n  wobbleStep: 0.07,\n  wobbleAmount: 3,\n  circleSizeScaler: 0.4,\n  circleSizeDrawThresh: 2,\n  lineWidthScaler: 0.4,\n  minCircleSize: 1,\n  fillTextFontSizeScaler: 0.2,\n  radOffsetScaler: 0.05,\n  fontSizeScaler: 0.4,\n  touchingScaler: 1.0\n};\n\nclass Port {\n  constructor (params, parent, type, index) {\n    this.params = params;\n    this.context = this.params.context;\n\n    this._parent = parent;\n    this._type = type;\n    this._index = index;\n    this._name = \"\";\n\n    this.connections = {};\n\n    this._x = 0;\n    this._y = 0;\n    this.relX = 0;\n    this.relY = 0;\n\n    this._touched = false;\n    this._hovered = false;\n\n    this.sizeScaler = 0;\n    this.circleRad = undefined;\n    this._arcLineWidth = undefined;\n\n    this.wobbleCounter = Math.random() * utils.PI2;\n    this.wobbleStep = portDefaults.wobbleStep;\n    this.wobbleAmount = portDefaults.wobbleAmount;\n\n    this.circleSize = undefined;\n    this.lineWidth = undefined;\n    this.strokeStyle = utils.colors.background();\n    this.fillStyle = this._parent.color();\n    this.shouldDraw = false;\n\n    this.radOffset = undefined;\n\n    // the visible flag is used by Cords to determine if they should be shown\n    this._visible = false;\n  }\n\n  // GETTERS\n\n  get visible () { return this._visible }\n\n  get x () { return this._x }\n\n  get y () { return this._y }\n\n  get touched () { return this._touched; }\n\n  get hovered () { return this._hovered; }\n\n  get name () { return this._name; }\n\n  get index () { return this._index; }\n\n  get type () { return this._type; }\n\n  get parent () { return this._parent; }\n\n  get size () { return this._arcLineWidth; }\n\n  // SETTERS\n\n  set touched (state) { this._touched = state; }\n\n  set hovered (state) { this._hovered = state; }\n\n  set name (name) { this._name = name; }\n\n  update (sizeScaler, radLocation, isVisible) {\n    this.updateFrameSettings(sizeScaler, isVisible);\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % utils.PI2;\n    // Ports need an absolute coordinate on the screen\n    // because their position is used to determine when they are being\n    // interacted with\n    this._x = this.circleRad * Math.cos(radLocation) + this.relX;\n    this._y = this.circleRad * Math.sin(radLocation) + this.relY;\n  }\n\n  onScreenUpdate (rad, lineWidth, relX, relY) {\n    this.circleRad = rad;\n    this._arcLineWidth = lineWidth;\n    this.relX = relX;\n    this.relY = relY;\n  }\n\n  updateFrameSettings (sizeScaler, isVisible) {\n    this.sizeScaler = sizeScaler;\n    this.circleSize = this._arcLineWidth * this.sizeScaler * portDefaults.circleSizeScaler;\n    this._visible = isVisible;\n    if(this._visible && this.circleSize > portDefaults.circleSizeDrawThresh){\n      if(this.params.touchedPort && this.params.touchedPort.type !== this._type) {\n        // wobble the port's radius, if `touchedPort` is from the other circle\n        this.circleSize += (Math.sin(this.wobbleCounter) * this.wobbleAmount);\n      }\n      this.circleSize = utils.clipValue(\n        this.circleSize, portDefaults.minCircleSize, this._arcLineWidth);\n      this.lineWidth = Math.floor(this.circleSize * portDefaults.lineWidthScaler);\n    }\n\n    // settings for drawing the name\n    this.radOffset = this._parent.radius - (this.params.screenSize * portDefaults.radOffsetScaler);\n    this.fontSize = Math.floor(this.sizeScaler * this._arcLineWidth * portDefaults.fontSizeScaler);\n  }\n\n  draw () {;\n    if(this._visible){\n      this.context.save();\n      utils.drawArc(\n        this.context,\n        0, this.circleRad,\n        this.circleSize, 0, utils.PI2,\n        this.lineWidth, this.strokeStyle, this.fillStyle\n      )\n      this.context.restore();\n    }\n  }\n\n  drawName () {\n    this.context.save();\n    this.context.translate(this.radOffset, 0);\n\n    if(this._x < this._parent.parent.centerX){\n      this.context.textAlign = 'left';\n      this.context.rotate(Math.PI);\n    }\n    else{\n      this.context.textAlign = 'right';\n    }\n    this.context.font = this.fontSize + 'px Helvetica';\n    if(this._touched || this._hovered) {\n      this.context.fillStyle = utils.colors.white();\n    }\n    else {\n      this.context.fillStyle = this.fillStyle;\n    }\n\n    this.context.fillText(\n      this._name, 0, this.fontSize * portDefaults.fillTextFontSizeScaler);\n    this.context.restore();\n  }\n\n  isTouching (x, y) {\n    const dist = utils.getDistance(this._x, this._y, x, y);\n    if (this._visible && dist < this.circleSize) {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport { Port }\n"]},"metadata":{},"sourceType":"module"}