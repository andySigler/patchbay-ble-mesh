{"ast":null,"code":"import * as utils from './DrawUtils';\nconst cordDefaults = {\n  width: 2,\n  wobbleStep: 0.05,\n  wobbleAmount: 2,\n  deleteScaler: 0.4,\n  lineWidthScaler: 0.003,\n  lineWidthOpacityScaler: 2,\n  circleSizeOpacityScaler: 2,\n  opacityScaler: 1.5,\n  deleteLineWidthScaler: 0.15,\n  wobbleSizeScaler: 0.5,\n  wobbleLineLengthScaler: 0.6\n};\n\nclass Connection {\n  constructor(params, inPort, outPort) {\n    this.params = params;\n    this.name = this.constructor.generateName(inPort, outPort); // references to the parent Ports (in/out)\n\n    this.inPort = inPort;\n    this.outPort = outPort;\n    this._exists = true;\n    this._hovered = false;\n    this.stroke = undefined;\n    this.lineWidth = cordDefaults.width; // the location and size of the delete circle\n\n    this._x = undefined;\n    this._y = undefined;\n    this._deleteSize = this.inPort.radius * cordDefaults.deleteScaler; // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n\n    this.wobbleCounter = Math.random() * Math.PI * 2;\n    this.wobbleStep = cordDefaults.wobbleStep;\n    this.wobbleAmount = cordDefaults.wobbleAmount;\n    this.circleSize = undefined;\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n    this.delLineWidth = undefined;\n    this.wobbleSize = undefined;\n    this.wobbleLineLength = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID_inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(inID + '/' + inIndex + '_' + outID + '/' + outIndex);\n  } // GETTERS\n\n\n  get hovered() {\n    return this._hovered;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get deleteSize() {\n    return this._deleteSize;\n  }\n\n  get exists() {\n    return this._exists;\n  } // SETTERS\n\n\n  set exists(newVal) {\n    this._exists = newVal;\n  }\n\n  set hovered(newVal) {\n    this._hovered = newVal;\n  }\n\n  update() {\n    // the coordinate where a deletion circle would be\n    // will be halfway between the two ports\n    this._x = (this.outPort.x - this.inPort.x) / 2 + this.inPort.x;\n    this._y = (this.outPort.y - this.inPort.y) / 2 + this.inPort.y; // incase the overall size has changed, update the size variables\n\n    this._deleteSize = this.inPort.radius * cordDefaults.deleteScaler;\n    this.lineWidth = Math.max(this.params.screenSize * cordDefaults.lineWidthScaler, 2); // increment the sinusoidal wobbling variable\n\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % (Math.PI * 2);\n    this.updateDrawSettings();\n  }\n\n  updateDrawSettings() {\n    // the visible flag is set by the Arc\n    if (this.outPort.visible && this.inPort.visible) {\n      // the opacity depends on the size of the parent ports' circles\n      let opacity = Math.min(this.outPort.sizeScaler, this.inPort.sizeScaler);\n      opacity = Math.min(opacity * cordDefaults.opacityScaler, 1); // that scaled opacity then controls all other variables for the line\n\n      this.lineWidth = Math.floor(this.lineWidth * opacity * cordDefaults.lineWidthOpacityScaler);\n      this.circleSize = Math.floor(this.lineWidth * opacity * cordDefaults.circleSizeOpacityScaler);\n      this.lineFill = utils.colors.white(opacity);\n      this.lineStroke = utils.colors.white(opacity);\n\n      if (this._hovered) {\n        this.lineStroke = utils.colors.red(opacity);\n        this.delCircleFill = utils.colors.white(opacity);\n        this.delCircleStroke = utils.colors.red(opacity);\n        const sineVal = this._deleteSize + Math.sin(this.wobbleCounter) * this.wobbleAmount;\n        this.delLineWidth = sineVal * cordDefaults.deleteLineWidthScaler;\n        this.wobbleSize = sineVal * opacity * cordDefaults.wobbleSizeScaler;\n        this.wobbleLineLength = this.wobbleSize * cordDefaults.wobbleLineLengthScaler;\n      }\n    }\n  }\n\n  draw() {\n    if (this.outPort.visible && this.inPort.visible) {\n      // save the context state\n      this.params.context.save(); // draw the line, from the input port to the output port\n\n      utils.drawLine(this.params.context, this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y, this.lineWidth, this.lineStroke); // draw the two circles on top of that line, inside each port\n\n      utils.drawArc(this.params.context, this.outPort.x, this.outPort.y, this.circleSize, 0, utils.PI2, this.lineWidth, undefined, this.lineFill);\n      utils.drawArc(this.params.context, this.inPort.x, this.inPort.y, this.circleSize, 0, utils.PI2, this.lineWidth, undefined, this.lineFill); // restore the context state\n\n      this.params.context.restore();\n\n      if (this._hovered) {\n        // save the context's state\n        this.params.context.save(); // translate to where the delete circle is\n\n        this.params.context.translate(this._x, this._y); // draw the circle, with a fill and a stroke\n\n        utils.drawArc(this.params.context, 0, 0, this.wobbleSize, 0, utils.PI2, this.lineWidth, this.delCircleStroke, this.delCircleFill); // draw the two lines that make the X\n\n        this.params.context.rotate(utils.PI / 4);\n        utils.drawLine(this.params.context, 0, this.wobbleLineLength, 0, -this.wobbleLineLength, this.delLineWidth, this.delCircleStroke);\n        this.params.context.rotate(-utils.PI / 2);\n        utils.drawLine(this.params.context, 0, this.wobbleLineLength, 0, -this.wobbleLineLength, this.delLineWidth, this.delCircleStroke); // restore the context's state\n\n        this.params.context.restore();\n      }\n    }\n  }\n\n  isUserTouching(x, y) {\n    const dist = utils.getDistance(x, y, this._x, this._y);\n\n    if (dist < this._deleteSize) {\n      return true;\n    }\n\n    return false;\n  }\n\n}\n\nexport { Connection };","map":{"version":3,"sources":["/Users/andy/Documents/patchbay-react/patchbay-react/src/modules/Connection.js"],"names":["utils","cordDefaults","width","wobbleStep","wobbleAmount","deleteScaler","lineWidthScaler","lineWidthOpacityScaler","circleSizeOpacityScaler","opacityScaler","deleteLineWidthScaler","wobbleSizeScaler","wobbleLineLengthScaler","Connection","constructor","params","inPort","outPort","name","generateName","_exists","_hovered","stroke","undefined","lineWidth","_x","_y","_deleteSize","radius","wobbleCounter","Math","random","PI","circleSize","lineFill","lineStroke","delCircleFill","delCircleStroke","delLineWidth","wobbleSize","wobbleLineLength","inID","parent","id","inIndex","index","outID","outIndex","String","hovered","x","y","deleteSize","exists","newVal","update","max","screenSize","updateDrawSettings","visible","opacity","min","sizeScaler","floor","colors","white","red","sineVal","sin","draw","context","save","drawLine","drawArc","PI2","restore","translate","rotate","isUserTouching","dist","getDistance"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,aAAvB;AAEA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,KAAK,EAAE,CADY;AAEnBC,EAAAA,UAAU,EAAE,IAFO;AAGnBC,EAAAA,YAAY,EAAE,CAHK;AAInBC,EAAAA,YAAY,EAAE,GAJK;AAKnBC,EAAAA,eAAe,EAAE,KALE;AAMnBC,EAAAA,sBAAsB,EAAE,CANL;AAOnBC,EAAAA,uBAAuB,EAAE,CAPN;AAQnBC,EAAAA,aAAa,EAAE,GARI;AASnBC,EAAAA,qBAAqB,EAAE,IATJ;AAUnBC,EAAAA,gBAAgB,EAAE,GAVC;AAWnBC,EAAAA,sBAAsB,EAAE;AAXL,CAArB;;AAcA,MAAMC,UAAN,CAAiB;AACfC,EAAAA,WAAW,CAAEC,MAAF,EAAUC,MAAV,EAAkBC,OAAlB,EAA2B;AACpC,SAAKF,MAAL,GAAcA,MAAd;AACA,SAAKG,IAAL,GAAY,KAAKJ,WAAL,CAAiBK,YAAjB,CAA8BH,MAA9B,EAAsCC,OAAtC,CAAZ,CAFoC,CAIpC;;AACA,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKC,OAAL,GAAeA,OAAf;AAEA,SAAKG,OAAL,GAAe,IAAf;AACA,SAAKC,QAAL,GAAgB,KAAhB;AAEA,SAAKC,MAAL,GAAcC,SAAd;AACA,SAAKC,SAAL,GAAiBvB,YAAY,CAACC,KAA9B,CAZoC,CAcpC;;AACA,SAAKuB,EAAL,GAAUF,SAAV;AACA,SAAKG,EAAL,GAAUH,SAAV;AACA,SAAKI,WAAL,GAAmB,KAAKX,MAAL,CAAYY,MAAZ,GAAqB3B,YAAY,CAACI,YAArD,CAjBoC,CAmBpC;AACA;;AACA,SAAKwB,aAAL,GAAqBC,IAAI,CAACC,MAAL,KAAgBD,IAAI,CAACE,EAArB,GAA0B,CAA/C;AACA,SAAK7B,UAAL,GAAkBF,YAAY,CAACE,UAA/B;AACA,SAAKC,YAAL,GAAoBH,YAAY,CAACG,YAAjC;AAEA,SAAK6B,UAAL,GAAkBV,SAAlB;AACA,SAAKW,QAAL,GAAgBX,SAAhB;AACA,SAAKY,UAAL,GAAkBZ,SAAlB;AACA,SAAKa,aAAL,GAAqBb,SAArB;AACA,SAAKc,eAAL,GAAuBd,SAAvB;AACA,SAAKe,YAAL,GAAoBf,SAApB;AACA,SAAKgB,UAAL,GAAkBhB,SAAlB;AACA,SAAKiB,gBAAL,GAAwBjB,SAAxB;AACD;;AAED,SAAOJ,YAAP,CAAoBH,MAApB,EAA4BC,OAA5B,EAAqC;AACnC;AACA,UAAMwB,IAAI,GAAGzB,MAAM,CAAC0B,MAAP,CAAcC,EAA3B;AACA,UAAMC,OAAO,GAAG5B,MAAM,CAAC6B,KAAvB;AACA,UAAMC,KAAK,GAAG7B,OAAO,CAACyB,MAAR,CAAeC,EAA7B;AACA,UAAMI,QAAQ,GAAG9B,OAAO,CAAC4B,KAAzB;AACA,WAAOG,MAAM,CACXP,IAAI,GAAG,GAAP,GAAaG,OAAb,GAAuB,GAAvB,GAA6BE,KAA7B,GAAqC,GAArC,GAA2CC,QADhC,CAAb;AAED,GA5Cc,CA8Cf;;;AAEA,MAAIE,OAAJ,GAAe;AAAE,WAAO,KAAK5B,QAAZ;AAAsB;;AAEvC,MAAI6B,CAAJ,GAAS;AAAE,WAAO,KAAKzB,EAAZ;AAAgB;;AAE3B,MAAI0B,CAAJ,GAAS;AAAE,WAAO,KAAKzB,EAAZ;AAAgB;;AAE3B,MAAI0B,UAAJ,GAAkB;AAAE,WAAO,KAAKzB,WAAZ;AAAyB;;AAE7C,MAAI0B,MAAJ,GAAc;AAAE,WAAO,KAAKjC,OAAZ;AAAsB,GAxDvB,CA0Df;;;AAEA,MAAIiC,MAAJ,CAAYC,MAAZ,EAAoB;AAAE,SAAKlC,OAAL,GAAekC,MAAf;AAAwB;;AAE9C,MAAIL,OAAJ,CAAaK,MAAb,EAAqB;AAAE,SAAKjC,QAAL,GAAeiC,MAAf;AAAwB;;AAE/CC,EAAAA,MAAM,GAAI;AACR;AACA;AACA,SAAK9B,EAAL,GAAW,CAAC,KAAKR,OAAL,CAAaiC,CAAb,GAAiB,KAAKlC,MAAL,CAAYkC,CAA9B,IAAmC,CAApC,GAAyC,KAAKlC,MAAL,CAAYkC,CAA/D;AACA,SAAKxB,EAAL,GAAW,CAAC,KAAKT,OAAL,CAAakC,CAAb,GAAiB,KAAKnC,MAAL,CAAYmC,CAA9B,IAAmC,CAApC,GAAyC,KAAKnC,MAAL,CAAYmC,CAA/D,CAJQ,CAMR;;AACA,SAAKxB,WAAL,GAAmB,KAAKX,MAAL,CAAYY,MAAZ,GAAqB3B,YAAY,CAACI,YAArD;AACA,SAAKmB,SAAL,GAAiBM,IAAI,CAAC0B,GAAL,CAAS,KAAKzC,MAAL,CAAY0C,UAAZ,GAAyBxD,YAAY,CAACK,eAA/C,EAAgE,CAAhE,CAAjB,CARQ,CAUR;;AACA,SAAKuB,aAAL,GAAqB,CAAC,KAAKA,aAAL,GAAqB,KAAK1B,UAA3B,KAA0C2B,IAAI,CAACE,EAAL,GAAU,CAApD,CAArB;AAEA,SAAK0B,kBAAL;AACD;;AAEDA,EAAAA,kBAAkB,GAAI;AACpB;AACA,QAAG,KAAKzC,OAAL,CAAa0C,OAAb,IAAwB,KAAK3C,MAAL,CAAY2C,OAAvC,EAA+C;AAC7C;AACA,UAAIC,OAAO,GAAG9B,IAAI,CAAC+B,GAAL,CAAS,KAAK5C,OAAL,CAAa6C,UAAtB,EAAkC,KAAK9C,MAAL,CAAY8C,UAA9C,CAAd;AACAF,MAAAA,OAAO,GAAG9B,IAAI,CAAC+B,GAAL,CAASD,OAAO,GAAG3D,YAAY,CAACQ,aAAhC,EAA+C,CAA/C,CAAV,CAH6C,CAI7C;;AACA,WAAKe,SAAL,GAAiBM,IAAI,CAACiC,KAAL,CAAW,KAAKvC,SAAL,GAAiBoC,OAAjB,GAA2B3D,YAAY,CAACM,sBAAnD,CAAjB;AACA,WAAK0B,UAAL,GAAmBH,IAAI,CAACiC,KAAL,CAAW,KAAKvC,SAAL,GAAiBoC,OAAjB,GAA2B3D,YAAY,CAACO,uBAAnD,CAAnB;AACA,WAAK0B,QAAL,GAAgBlC,KAAK,CAACgE,MAAN,CAAaC,KAAb,CAAmBL,OAAnB,CAAhB;AACA,WAAKzB,UAAL,GAAkBnC,KAAK,CAACgE,MAAN,CAAaC,KAAb,CAAmBL,OAAnB,CAAlB;;AACA,UAAG,KAAKvC,QAAR,EAAkB;AAChB,aAAKc,UAAL,GAAkBnC,KAAK,CAACgE,MAAN,CAAaE,GAAb,CAAiBN,OAAjB,CAAlB;AACA,aAAKxB,aAAL,GAAqBpC,KAAK,CAACgE,MAAN,CAAaC,KAAb,CAAmBL,OAAnB,CAArB;AACA,aAAKvB,eAAL,GAAuBrC,KAAK,CAACgE,MAAN,CAAaE,GAAb,CAAiBN,OAAjB,CAAvB;AACA,cAAMO,OAAO,GAAG,KAAKxC,WAAL,GAAoBG,IAAI,CAACsC,GAAL,CAAS,KAAKvC,aAAd,IAA+B,KAAKzB,YAAxE;AACA,aAAKkC,YAAL,GAAoB6B,OAAO,GAAGlE,YAAY,CAACS,qBAA3C;AACA,aAAK6B,UAAL,GAAkB4B,OAAO,GAAGP,OAAV,GAAoB3D,YAAY,CAACU,gBAAnD;AACA,aAAK6B,gBAAL,GAAwB,KAAKD,UAAL,GAAkBtC,YAAY,CAACW,sBAAvD;AACD;AACF;AACF;;AAEDyD,EAAAA,IAAI,GAAI;AACN,QAAG,KAAKpD,OAAL,CAAa0C,OAAb,IAAwB,KAAK3C,MAAL,CAAY2C,OAAvC,EAA+C;AAC7C;AACA,WAAK5C,MAAL,CAAYuD,OAAZ,CAAoBC,IAApB,GAF6C,CAG7C;;AACAvE,MAAAA,KAAK,CAACwE,QAAN,CACE,KAAKzD,MAAL,CAAYuD,OADd,EAEE,KAAKrD,OAAL,CAAaiC,CAFf,EAEkB,KAAKjC,OAAL,CAAakC,CAF/B,EAEkC,KAAKnC,MAAL,CAAYkC,CAF9C,EAEiD,KAAKlC,MAAL,CAAYmC,CAF7D,EAGE,KAAK3B,SAHP,EAGkB,KAAKW,UAHvB,EAJ6C,CAS7C;;AACAnC,MAAAA,KAAK,CAACyE,OAAN,CACE,KAAK1D,MAAL,CAAYuD,OADd,EAEE,KAAKrD,OAAL,CAAaiC,CAFf,EAEkB,KAAKjC,OAAL,CAAakC,CAF/B,EAGE,KAAKlB,UAHP,EAGmB,CAHnB,EAGsBjC,KAAK,CAAC0E,GAH5B,EAIE,KAAKlD,SAJP,EAIkBD,SAJlB,EAI6B,KAAKW,QAJlC;AAMAlC,MAAAA,KAAK,CAACyE,OAAN,CACE,KAAK1D,MAAL,CAAYuD,OADd,EAEE,KAAKtD,MAAL,CAAYkC,CAFd,EAEiB,KAAKlC,MAAL,CAAYmC,CAF7B,EAGE,KAAKlB,UAHP,EAGmB,CAHnB,EAGsBjC,KAAK,CAAC0E,GAH5B,EAIE,KAAKlD,SAJP,EAIkBD,SAJlB,EAI6B,KAAKW,QAJlC,EAhB6C,CAsB7C;;AACA,WAAKnB,MAAL,CAAYuD,OAAZ,CAAoBK,OAApB;;AACA,UAAG,KAAKtD,QAAR,EAAiB;AACf;AACA,aAAKN,MAAL,CAAYuD,OAAZ,CAAoBC,IAApB,GAFe,CAIf;;AACA,aAAKxD,MAAL,CAAYuD,OAAZ,CAAoBM,SAApB,CAA8B,KAAKnD,EAAnC,EAAuC,KAAKC,EAA5C,EALe,CAMf;;AACA1B,QAAAA,KAAK,CAACyE,OAAN,CACE,KAAK1D,MAAL,CAAYuD,OADd,EAEE,CAFF,EAEK,CAFL,EAGE,KAAK/B,UAHP,EAGmB,CAHnB,EAGsBvC,KAAK,CAAC0E,GAH5B,EAIE,KAAKlD,SAJP,EAIkB,KAAKa,eAJvB,EAIwC,KAAKD,aAJ7C,EAPe,CAaf;;AACA,aAAKrB,MAAL,CAAYuD,OAAZ,CAAoBO,MAApB,CAA2B7E,KAAK,CAACgC,EAAN,GAAW,CAAtC;AACAhC,QAAAA,KAAK,CAACwE,QAAN,CACE,KAAKzD,MAAL,CAAYuD,OADd,EAEE,CAFF,EAEK,KAAK9B,gBAFV,EAE4B,CAF5B,EAE+B,CAAC,KAAKA,gBAFrC,EAGE,KAAKF,YAHP,EAGqB,KAAKD,eAH1B;AAKA,aAAKtB,MAAL,CAAYuD,OAAZ,CAAoBO,MAApB,CAA2B,CAAC7E,KAAK,CAACgC,EAAP,GAAY,CAAvC;AACAhC,QAAAA,KAAK,CAACwE,QAAN,CACE,KAAKzD,MAAL,CAAYuD,OADd,EAEE,CAFF,EAEK,KAAK9B,gBAFV,EAE4B,CAF5B,EAE+B,CAAC,KAAKA,gBAFrC,EAGE,KAAKF,YAHP,EAGqB,KAAKD,eAH1B,EArBe,CA0Bf;;AACA,aAAKtB,MAAL,CAAYuD,OAAZ,CAAoBK,OAApB;AACD;AACF;AACF;;AAEDG,EAAAA,cAAc,CAAE5B,CAAF,EAAKC,CAAL,EAAQ;AACpB,UAAM4B,IAAI,GAAG/E,KAAK,CAACgF,WAAN,CAAkB9B,CAAlB,EAAqBC,CAArB,EAAwB,KAAK1B,EAA7B,EAAiC,KAAKC,EAAtC,CAAb;;AACA,QAAIqD,IAAI,GAAG,KAAKpD,WAAhB,EAA6B;AAC3B,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD;;AAtKc;;AAyKjB,SAASd,UAAT","sourcesContent":["import * as utils from './DrawUtils'\n\nconst cordDefaults = {\n  width: 2,\n  wobbleStep: 0.05,\n  wobbleAmount: 2,\n  deleteScaler: 0.4,\n  lineWidthScaler: 0.003,\n  lineWidthOpacityScaler: 2,\n  circleSizeOpacityScaler: 2,\n  opacityScaler: 1.5,\n  deleteLineWidthScaler: 0.15,\n  wobbleSizeScaler: 0.5,\n  wobbleLineLengthScaler: 0.6\n};\n\nclass Connection {\n  constructor (params, inPort, outPort) {\n    this.params = params;\n    this.name = this.constructor.generateName(inPort, outPort);\n\n    // references to the parent Ports (in/out)\n    this.inPort = inPort;\n    this.outPort = outPort;\n\n    this._exists = true;\n    this._hovered = false;\n\n    this.stroke = undefined;\n    this.lineWidth = cordDefaults.width;\n\n    // the location and size of the delete circle\n    this._x = undefined;\n    this._y = undefined;\n    this._deleteSize = this.inPort.radius * cordDefaults.deleteScaler;\n\n    // some variables to keep track of the sinusoidal pulsing\n    // when hovered for deletion\n    this.wobbleCounter = Math.random() * Math.PI * 2;\n    this.wobbleStep = cordDefaults.wobbleStep;\n    this.wobbleAmount = cordDefaults.wobbleAmount;\n\n    this.circleSize = undefined;\n    this.lineFill = undefined;\n    this.lineStroke = undefined;\n    this.delCircleFill = undefined;\n    this.delCircleStroke = undefined;\n    this.delLineWidth = undefined;\n    this.wobbleSize = undefined;\n    this.wobbleLineLength = undefined;\n  }\n\n  static generateName(inPort, outPort) {\n    // \"outArcID/inArcID_inPortID/outPortID\"\n    const inID = inPort.parent.id;\n    const inIndex = inPort.index;\n    const outID = outPort.parent.id;\n    const outIndex = outPort.index;\n    return String(\n      inID + '/' + inIndex + '_' + outID + '/' + outIndex);\n  }\n\n  // GETTERS\n\n  get hovered () { return this._hovered }\n\n  get x () { return this._x }\n\n  get y () { return this._y }\n\n  get deleteSize () { return this._deleteSize }\n\n  get exists () { return this._exists; }\n\n  // SETTERS\n\n  set exists (newVal) { this._exists = newVal; }\n\n  set hovered (newVal) { this._hovered =newVal; }\n\n  update () {\n    // the coordinate where a deletion circle would be\n    // will be halfway between the two ports\n    this._x = ((this.outPort.x - this.inPort.x) / 2) + this.inPort.x;\n    this._y = ((this.outPort.y - this.inPort.y) / 2) + this.inPort.y;\n\n    // incase the overall size has changed, update the size variables\n    this._deleteSize = this.inPort.radius * cordDefaults.deleteScaler;\n    this.lineWidth = Math.max(this.params.screenSize * cordDefaults.lineWidthScaler, 2);\n\n    // increment the sinusoidal wobbling variable\n    this.wobbleCounter = (this.wobbleCounter + this.wobbleStep) % (Math.PI * 2);\n\n    this.updateDrawSettings();\n  }\n\n  updateDrawSettings () {\n    // the visible flag is set by the Arc\n    if(this.outPort.visible && this.inPort.visible){\n      // the opacity depends on the size of the parent ports' circles\n      let opacity = Math.min(this.outPort.sizeScaler, this.inPort.sizeScaler);\n      opacity = Math.min(opacity * cordDefaults.opacityScaler, 1);\n      // that scaled opacity then controls all other variables for the line\n      this.lineWidth = Math.floor(this.lineWidth * opacity * cordDefaults.lineWidthOpacityScaler);\n      this.circleSize =  Math.floor(this.lineWidth * opacity * cordDefaults.circleSizeOpacityScaler);\n      this.lineFill = utils.colors.white(opacity);\n      this.lineStroke = utils.colors.white(opacity);\n      if(this._hovered) {\n        this.lineStroke = utils.colors.red(opacity);\n        this.delCircleFill = utils.colors.white(opacity);\n        this.delCircleStroke = utils.colors.red(opacity);\n        const sineVal = this._deleteSize + (Math.sin(this.wobbleCounter) * this.wobbleAmount);\n        this.delLineWidth = sineVal * cordDefaults.deleteLineWidthScaler;\n        this.wobbleSize = sineVal * opacity * cordDefaults.wobbleSizeScaler;\n        this.wobbleLineLength = this.wobbleSize * cordDefaults.wobbleLineLengthScaler;\n      }\n    }\n  }\n\n  draw () {\n    if(this.outPort.visible && this.inPort.visible){\n      // save the context state\n      this.params.context.save();\n      // draw the line, from the input port to the output port\n      utils.drawLine(\n        this.params.context,\n        this.outPort.x, this.outPort.y, this.inPort.x, this.inPort.y,\n        this.lineWidth, this.lineStroke\n      );\n      // draw the two circles on top of that line, inside each port\n      utils.drawArc(\n        this.params.context,\n        this.outPort.x, this.outPort.y,\n        this.circleSize, 0, utils.PI2,\n        this.lineWidth, undefined, this.lineFill\n      )\n      utils.drawArc(\n        this.params.context,\n        this.inPort.x, this.inPort.y,\n        this.circleSize, 0, utils.PI2,\n        this.lineWidth, undefined, this.lineFill\n      )\n      // restore the context state\n      this.params.context.restore();\n      if(this._hovered){\n        // save the context's state\n        this.params.context.save();\n\n        // translate to where the delete circle is\n        this.params.context.translate(this._x, this._y);\n        // draw the circle, with a fill and a stroke\n        utils.drawArc(\n          this.params.context,\n          0, 0,\n          this.wobbleSize, 0, utils.PI2,\n          this.lineWidth, this.delCircleStroke, this.delCircleFill\n        )\n        // draw the two lines that make the X\n        this.params.context.rotate(utils.PI / 4);\n        utils.drawLine(\n          this.params.context,\n          0, this.wobbleLineLength, 0, -this.wobbleLineLength,\n          this.delLineWidth, this.delCircleStroke\n        );\n        this.params.context.rotate(-utils.PI / 2);\n        utils.drawLine(\n          this.params.context,\n          0, this.wobbleLineLength, 0, -this.wobbleLineLength,\n          this.delLineWidth, this.delCircleStroke\n        );\n        // restore the context's state\n        this.params.context.restore();\n      }\n    }\n  }\n\n  isUserTouching (x, y) {\n    const dist = utils.getDistance(x, y, this._x, this._y);\n    if (dist < this._deleteSize) {\n      return true;\n    }\n    return false;\n  }\n}\n\nexport { Connection }\n"]},"metadata":{},"sourceType":"module"}