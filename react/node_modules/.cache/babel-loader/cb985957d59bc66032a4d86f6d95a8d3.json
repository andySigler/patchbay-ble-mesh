{"ast":null,"code":"import * as utils from './DrawUtils';\nimport { Port } from './Port';\nconst arcDefaults = {\n  touchingScaler: 1.0,\n  emptyArcThicknessScaler: 0.1,\n  arcThicknessScaler: 0.65,\n  gutterLineWidthScaler: 0.45,\n  gutterScaler: 0.006,\n  sizeScalerMultiplier: 1.7,\n  sizeScalerThresh: 0.85,\n  angleOffset: {\n    in: 0.375,\n    out: .875\n  }\n};\n\nclass Arc {\n  constructor(params, parent, type, color, name, id, index) {\n    this.params = params;\n    this.context = params.context;\n    this._parent = parent;\n    this._type = type;\n    this._color = color;\n    this._name = name;\n    this._id = id;\n    this._index = index;\n    this._sizeScaler = 0;\n    this._ports = [];\n    this._focused = false;\n    this._touched = false;\n    this._isSelected = false;\n    this.start = undefined;\n    this.end = undefined;\n    this.angleOffset = arcDefaults.angleOffset[this._type] * utils.PI2;\n    this.radius = undefined;\n    this.lineWidth = undefined;\n    this.arcThickness = undefined;\n    this.arcThicknessScaler = arcDefaults.emptyArcThicknessScaler;\n    this.shouldDrawGutter = false;\n    this.gutterStart = undefined;\n    this.gutterEnd = undefined;\n    this.gutterLineWidth = undefined;\n    this.test = true;\n  } // GETTERS\n\n\n  get isSelected() {\n    return this._isSelected;\n  }\n\n  get parent() {\n    return this._parent;\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  get color() {\n    return this._color;\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get index() {\n    return this._index;\n  }\n\n  get ports() {\n    return this._ports;\n  }\n\n  get focused() {\n    return this._focused;\n  }\n\n  get touched() {\n    return this._touched;\n  }\n\n  get sizeScaler() {\n    return this._sizeScaler;\n  } // SETTERS\n\n\n  set focused(newVal) {\n    this._focused = newVal;\n  }\n\n  set touched(newVal) {\n    this._touched = newVal;\n  }\n\n  holdsTouchedPort() {\n    const port = this.params.touchedPort;\n    return Boolean(port && port.parent === this);\n  }\n\n  holdsHoveredPort() {\n    const port = this.params.hoveredPort;\n    return Boolean(port && port.parent === this);\n  }\n\n  addPort(index) {\n    // a port is simply labelled by it's index\n    const tempPort = new Port(this.params, this, this._type, index, this._color());\n    this._ports[index] = tempPort; // update some draw settings that change when ports > 0\n\n    this.shouldDrawGutter = this._type === this.params.inType;\n    this.arcThicknessScaler = arcDefaults.arcThicknessScaler;\n  }\n\n  onScreenUpdate(radius, lineWidth, circleX, circleY) {\n    this.radius = radius;\n    this.lineWidth = lineWidth;\n\n    for (let port of this._ports) {\n      port.onScreenUpdate(radius, lineWidth, circleX, circleY);\n    }\n  }\n\n  update(start, end, isSelected, sizeScaler) {\n    // update this Arc's visual draw settings\n    this._sizeScaler = this.modifySizeScaler(sizeScaler);\n    this._isSelected = isSelected;\n    this.start = (start + this.angleOffset) % utils.PI2;\n    this.end = (end + this.angleOffset) % utils.PI2;\n\n    if (this.end < this.start) {\n      this.end += utils.PI2;\n    }\n\n    this.arcThickness = utils.clipValue(this.lineWidth * this.arcThicknessScaler, 1, Math.inf);\n    this.updatePorts();\n\n    if (this.shouldDrawGutter) {\n      this.updateGutter();\n    }\n\n    if (this._type == 'in' && this.id === 2) {\n      console.log(this._ports.length, this.arcThicknessScaler, this.lineWidth, this.arcThickness);\n    }\n  }\n\n  updateGutter() {\n    // if it's an Input Arc and is selected, give it an inner grey \"gutter\"\n    this.gutterLineWidth = Math.max(this.lineWidth * arcDefaults.gutterLineWidthScaler, 1);\n    this.gutterStart = this.start + utils.PI2 * arcDefaults.gutterScaler;\n    this.gutterEnd = this.end - utils.PI2 * arcDefaults.gutterScaler;\n  }\n\n  updatePorts() {\n    // update each Port's visual draw settings\n    this.rotStep = (this.end - this.start) / this._ports.length;\n\n    for (let i = 0; i < this._ports.length; i++) {\n      const radLocation = this.start + this.rotStep * i + this.rotStep / 2;\n\n      this._ports[i].update(this._sizeScaler, radLocation, this._isSelected);\n    }\n  }\n\n  getTouchedPort(x, y) {\n    for (let i = 0; i < this._ports.length; i++) {\n      if (this._ports[i].isUserTouching(x, y)) {\n        return this._ports[i];\n      }\n    }\n\n    return undefined;\n  }\n\n  drawArc() {\n    // save the context's state\n    this.context.save();\n    utils.drawArc(this.context, 0, 0, this.radius, this.start, this.end, this.arcThickness, this._color(), undefined); // draw a grey arc in the middle of the main arc\n\n    if (this.shouldDrawGutter) {\n      utils.drawArc(this.context, 0, 0, this.radius, this.gutterStart, this.gutterEnd, this.gutterLineWidth, utils.colors.background(), undefined);\n    }\n\n    this.context.restore();\n  }\n\n  drawName() {\n    this.context.save();\n    this.context.rotate(this.start + this.rotStep / 2);\n\n    for (let i = 0; i < this._ports.length; i++) {\n      if (this._ports[i]) {\n        this._ports[i].drawName();\n\n        this.context.rotate(this.rotStep);\n      }\n    }\n\n    this.context.restore();\n  }\n\n  drawPorts() {\n    // draw the child Ports\n    this.context.save();\n    this.context.rotate(this.start + this.rotStep / 2 - utils.PI * 0.5);\n\n    for (let i = 0; i < this._ports.length; i++) {\n      if (this._ports[i].visible) {\n        this._ports[i].draw(this._sizeScaler);\n      }\n\n      this.context.rotate(this.rotStep);\n    }\n\n    this.context.restore();\n  }\n\n  modifySizeScaler(sizeScaler) {\n    sizeScaler = utils.clipValue(sizeScaler * arcDefaults.sizeScalerMultiplier, 0, arcDefaults.sizeScalerThresh);\n    return Math.pow(sizeScaler / arcDefaults.sizeScalerThresh, 2);\n  }\n\n}\n\nexport { Arc };","map":{"version":3,"sources":["/Users/andy/Documents/patchbay-react/patchbay-react/src/modules/Arc.js"],"names":["utils","Port","arcDefaults","touchingScaler","emptyArcThicknessScaler","arcThicknessScaler","gutterLineWidthScaler","gutterScaler","sizeScalerMultiplier","sizeScalerThresh","angleOffset","in","out","Arc","constructor","params","parent","type","color","name","id","index","context","_parent","_type","_color","_name","_id","_index","_sizeScaler","_ports","_focused","_touched","_isSelected","start","undefined","end","PI2","radius","lineWidth","arcThickness","shouldDrawGutter","gutterStart","gutterEnd","gutterLineWidth","test","isSelected","ports","focused","touched","sizeScaler","newVal","holdsTouchedPort","port","touchedPort","Boolean","holdsHoveredPort","hoveredPort","addPort","tempPort","inType","onScreenUpdate","circleX","circleY","update","modifySizeScaler","clipValue","Math","inf","updatePorts","updateGutter","console","log","length","max","rotStep","i","radLocation","getTouchedPort","x","y","isUserTouching","drawArc","save","colors","background","restore","drawName","rotate","drawPorts","PI","visible","draw","pow"],"mappings":"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","sourcesContent":["import * as utils from './DrawUtils'\nimport { Port } from './Port'\n\n\nconst arcDefaults = {\n  touchingScaler: 1.0,\n  emptyArcThicknessScaler: 0.1,\n  arcThicknessScaler: 0.65,\n  gutterLineWidthScaler: 0.45,\n  gutterScaler: 0.006,\n  sizeScalerMultiplier: 1.7,\n  sizeScalerThresh: 0.85,\n  angleOffset: {in: 0.375, out: .875}\n};\n\nclass Arc {\n  constructor (params, parent, type, color, name, id, index) {\n    this.params = params;\n    this.context = params.context;\n\n    this._parent = parent;\n    this._type = type;\n    this._color = color;\n    this._name = name;\n    this._id = id;\n    this._index = index;\n\n    this._sizeScaler = 0;\n\n    this._ports = [];\n\n    this._focused = false;\n    this._touched = false;\n\n    this._isSelected = false;\n\n    this.start = undefined;\n    this.end = undefined;\n    this.angleOffset = arcDefaults.angleOffset[this._type] * utils.PI2;\n    this.radius = undefined;\n    this.lineWidth = undefined;\n    this.arcThickness = undefined;\n    this.arcThicknessScaler = arcDefaults.emptyArcThicknessScaler;\n\n    this.shouldDrawGutter = false;\n    this.gutterStart = undefined;\n    this.gutterEnd = undefined;\n    this.gutterLineWidth = undefined;\n\n    this.test = true;\n  }\n\n  // GETTERS\n\n  get isSelected () { return this._isSelected; }\n\n  get parent () { return this._parent; }\n\n  get type () { return this._type; }\n\n  get color () { return this._color; }\n\n  get name () { return this._name; }\n\n  get id () { return this._id; }\n\n  get index () { return this._index; }\n\n  get ports () { return this._ports; }\n\n  get focused () { return this._focused; }\n\n  get touched () { return this._touched; }\n\n  get sizeScaler () { return this._sizeScaler; }\n\n  // SETTERS\n\n  set focused (newVal) { this._focused = newVal; }\n\n  set touched (newVal) { this._touched = newVal; }\n\n  holdsTouchedPort () {\n    const port = this.params.touchedPort;\n    return Boolean(port && port.parent === this);\n  }\n\n  holdsHoveredPort () {\n    const port = this.params.hoveredPort;\n    return Boolean(port && port.parent === this);\n  }\n\n  addPort (index) {\n    // a port is simply labelled by it's index\n    const tempPort = new Port(this.params, this, this._type, index, this._color());\n    this._ports[index] = tempPort;\n    // update some draw settings that change when ports > 0\n    this.shouldDrawGutter = this._type === this.params.inType;\n    this.arcThicknessScaler = arcDefaults.arcThicknessScaler;\n  }\n\n  onScreenUpdate (radius, lineWidth, circleX, circleY) {\n    this.radius = radius;\n    this.lineWidth = lineWidth;\n    for (let port of this._ports) {\n      port.onScreenUpdate(radius, lineWidth, circleX, circleY);\n    }\n  }\n\n  update (start, end, isSelected, sizeScaler) {\n    // update this Arc's visual draw settings\n    this._sizeScaler = this.modifySizeScaler(sizeScaler);\n    this._isSelected = isSelected;\n    this.start = (start + this.angleOffset) % utils.PI2;\n    this.end = (end + this.angleOffset) % utils.PI2;\n    if (this.end < this.start) {\n      this.end += utils.PI2;\n    }\n    this.arcThickness = utils.clipValue(\n      this.lineWidth * this.arcThicknessScaler, 1, Math.inf);\n    this.updatePorts();\n    if (this.shouldDrawGutter) {\n      this.updateGutter();\n    }\n    if (this._type == 'in' && this.id === 2) {\n      console.log(this._ports.length, this.arcThicknessScaler, this.lineWidth, this.arcThickness);\n    }\n  }\n\n  updateGutter() {\n    // if it's an Input Arc and is selected, give it an inner grey \"gutter\"\n    this.gutterLineWidth = Math.max(\n      this.lineWidth * arcDefaults.gutterLineWidthScaler, 1);\n    this.gutterStart = this.start + (utils.PI2 * arcDefaults.gutterScaler);\n    this.gutterEnd = this.end - (utils.PI2 * arcDefaults.gutterScaler);\n  }\n\n  updatePorts () {\n    // update each Port's visual draw settings\n    this.rotStep = (this.end - this.start) / this._ports.length;\n    for (let i = 0; i < this._ports.length; i++) {\n      const radLocation = this.start + (this.rotStep * i) + (this.rotStep / 2);\n      this._ports[i].update(this._sizeScaler, radLocation, this._isSelected);\n    }\n  }\n\n  getTouchedPort (x, y) {\n    for (let i = 0; i < this._ports.length; i++) {\n      if (this._ports[i].isUserTouching(x, y)) {\n        return this._ports[i];\n      }\n    }\n    return undefined;\n  }\n\n  drawArc () {\n    // save the context's state\n    this.context.save();\n    utils.drawArc(\n      this.context,\n      0, 0, this.radius, this.start, this.end,\n      this.arcThickness, this._color(), undefined\n    )\n    // draw a grey arc in the middle of the main arc\n    if (this.shouldDrawGutter) {\n      utils.drawArc(\n        this.context,\n        0, 0, this.radius, this.gutterStart, this.gutterEnd,\n        this.gutterLineWidth, utils.colors.background(), undefined\n      )\n    }\n    this.context.restore();\n  }\n\n  drawName () {\n    this.context.save();\n    this.context.rotate(this.start + (this.rotStep / 2));\n    for (let i = 0;i < this._ports.length; i++) {\n      if (this._ports[i]) {\n        this._ports[i].drawName();\n        this.context.rotate(this.rotStep);\n      }\n    }\n    this.context.restore();\n  }\n\n  drawPorts () {\n    // draw the child Ports\n    this.context.save();\n    this.context.rotate((this.start + (this.rotStep / 2)) - (utils.PI * 0.5));\n    for (let i = 0; i < this._ports.length; i++) {\n      if (this._ports[i].visible) {\n        this._ports[i].draw(this._sizeScaler);\n      }\n      this.context.rotate(this.rotStep);\n    }\n    this.context.restore();\n  }\n\n  modifySizeScaler (sizeScaler) {\n    sizeScaler = utils.clipValue(\n      sizeScaler * arcDefaults.sizeScalerMultiplier,\n      0,\n      arcDefaults.sizeScalerThresh\n    );\n    return Math.pow(sizeScaler / arcDefaults.sizeScalerThresh, 2);\n  }\n}\n\nexport { Arc }\n"]},"metadata":{},"sourceType":"module"}